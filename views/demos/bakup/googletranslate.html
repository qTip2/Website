<?php $title = 'Google translation' ?>

<div id="demo-translation">
	<h4 class="right" style="margin-top: 2px;">Highlight any text to see a Spanish translation</h4>
	<h3>Wikipedia - Spain</h3>

	<img class="left" src="<?=IMAGES_DIR?>/demos/spain_flag.png" alt="" title="The Spanish flag" />
	<img class="right" src="<?=IMAGES_DIR?>/demos/spain_map.png" alt="" title="Map of Spain" />
	<div class="translate">
		<p>Spain, or the Kingdom of Spain, is a country located in southwestern Europe on the Iberian Peninsula. Its mainland is bordered to the south and east by the Mediterranean Sea except for a small land boundary with Gibraltar; to the north by France, Andorra, and the Bay of Biscay; and to the west by the Atlantic Ocean and Portugal. Spanish territory also includes the Balearic Islands in the Mediterranean, the Canary Islands in the Atlantic Ocean off the African coast, and two autonomous cities in North Africa, Ceuta and Melilla, that border Morocco. With an area of 504,030 kmÂ², Spain is the second largest country in Western Europe after France.</p>
		<p>Because of its location, the territory of Spain was subject to many external influences, often simultaneously, since prehistoric times and through the dawn of Spain as a country. On the other side, the country itself has been an important source of influence to other regions, chiefly during the Modern Era, when it became a global empire that has left a legacy of over 400 million Spanish speakers today.</p>
		<p>Spain is a democracy organised in the form of a parliamentary government under a constitutional monarchy. It is a developed country with the eighth largest economy in the world based on nominal GDP. It is a member of the European Union and NATO.</p>
	</div>

	<p class="attribution">Images: <a href="http://wikipedia.org/wiki/Spain">Wikipedia</a></p>
</div>


<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script class="example" type="text/javascript">
// Initialize google API
google.load("language", "1");

// Setup the selection grabber function
function getSelected()
{
	if(window.getSelection) { txt = window.getSelection().toString(); }
	else if(document.getSelection) { txt = document.getSelection().toString(); }
	else if(document.selection) { txt = document.selection.createRange().text; }

	return txt;
}

// Setup a single tooltip on the document body element
$(document.body).qtip(
{
	prerender: true, // Make sure its rendered at document load
	content: 'Translating...',
	position: {
		my: 'bottom left',
		at: 'top right',
		target: 'mouse', // Position it where the mouse up event happens...
		adjust: {
			mouse: false, // ... but don't follow the mouse
			screen: true // Keep it on screen if possible
		}
	},
	show: false, // Disable the default show event
	hide: 'unfocus', // Hide the tooltip when it loses focus
	style: {
		classes: 'ui-tooltip-translate ui-tooltip-shadow'
	}
})

.bind('mouseup', function(event) {
	// Grab the text that is selected
	var text = getSelected();

	// If the qTip was the target, hide the tooltips
	if(text.length)
	{
		// Retrieve API
		var api = $(this).qtip();

		// Set translating... as content and show the tooltip
		api.set('content.text', 'Translating...');
		api.show(event); // ..make sure to pass the event object!

		// Translate the text and set new content
		google.language.translate(text, "en", "es", function(result){
			api.set('content.text', result.translation);
		});
	}
});
</script>
